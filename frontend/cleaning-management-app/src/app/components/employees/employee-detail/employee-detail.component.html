<div class="employee-detail-container">
  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-card class="loading-card">
      <mat-card-content>
        <div class="loading-content">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Loading employee details...</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Employee Details -->
  <div class="employee-content" *ngIf="!isLoading && employee">
    <!-- Header Card -->
    <mat-card class="header-card">
      <mat-card-content>
        <div class="employee-header">
          <div class="employee-avatar">
            {{ employee.firstName[0] }}{{ employee.lastName[0] }}
          </div>
          <div class="employee-basic-info">
            <h1>{{ employee.firstName }} {{ employee.lastName }}</h1>
            <p class="employee-position">{{ employee.position }}</p>
            <div class="employee-status">
              <mat-chip
                [ngClass]="'status-' + employee.status.toLowerCase()"
                selected
              >
                <mat-icon>{{
                  employee.status === "Active"
                    ? "check_circle"
                    : employee.status === "Inactive"
                    ? "cancel"
                    : "schedule"
                }}</mat-icon>
                {{ employee.status }}
              </mat-chip>
            </div>
          </div>
          <div class="employee-actions">
            <button
              mat-fab
              color="primary"
              (click)="editEmployee()"
              matTooltip="Edit Employee"
            >
              <mat-icon>edit</mat-icon>
            </button>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Details Grid -->
    <div class="details-grid">
      <!-- Personal Information -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>person</mat-icon>
            Personal Information
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="info-grid">
            <div class="info-item">
              <label>Email</label>
              <div class="info-value">
                <mat-icon>email</mat-icon>
                <span>{{ employee.email }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>Phone</label>
              <div class="info-value">
                <mat-icon>phone</mat-icon>
                <span>{{ employee.phone }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>Address</label>
              <div class="info-value">
                <mat-icon>location_on</mat-icon>
                <span>{{ employee.address || "Not provided" }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>City, State</label>
              <div class="info-value">
                <mat-icon>place</mat-icon>
                <span
                  >{{ employee.city || "Not provided" }},
                  {{ employee.municipality || "N/A" }}</span
                >
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Employment Information -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>work</mat-icon>
            Employment Details
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="info-grid">
            <div class="info-item">
              <label>Department</label>
              <div class="info-value">
                <mat-icon>business</mat-icon>
                <span>{{ employee.department || "Not assigned" }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>Employment Type</label>
              <div class="info-value">
                <mat-icon>schedule</mat-icon>
                <span>{{ employee.employmentType || "Not specified" }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>Hourly Rate</label>
              <div class="info-value">
                <mat-icon>attach_money</mat-icon>
                <span>${{ employee.hourlyRate }}/hour</span>
              </div>
            </div>
            <div class="info-item">
              <label>Hire Date</label>
              <div class="info-value">
                <mat-icon>event</mat-icon>
                <span>{{ employee.hireDate | date : "mediumDate" }}</span>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Working Schedule -->
      <mat-card class="info-card schedule-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>access_time</mat-icon>
            Working Schedule
          </mat-card-title>
          <mat-card-subtitle>
            Total Weekly Hours: {{ getTotalWeeklyHours() }}h
          </mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div
            class="schedule-list"
            *ngIf="
              employee.workingDays && employee.workingDays.length > 0;
              else noSchedule
            "
          >
            <div class="schedule-item" *ngFor="let day of employee.workingDays">
              <div class="day-name">{{ day.day }}</div>
              <div class="time-range">
                <span class="time">{{ day.from }}</span>
                <mat-icon>arrow_forward</mat-icon>
                <span class="time">{{ day.to }}</span>
              </div>
              <div class="duration">{{ day.duration || 0 }}h</div>
            </div>
          </div>
          <ng-template #noSchedule>
            <div class="no-schedule">
              <mat-icon>schedule</mat-icon>
              <p>No working schedule set</p>
            </div>
          </ng-template>
        </mat-card-content>
      </mat-card>

      <!-- Skills & Certifications -->
      <mat-card
        class="info-card"
        *ngIf="employee.skills?.length || employee.certifications?.length"
      >
        <mat-card-header>
          <mat-card-title>
            <mat-icon>verified</mat-icon>
            Skills & Certifications
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="skills-section" *ngIf="employee.skills?.length">
            <h4>Skills</h4>
            <div class="chip-list">
              <mat-chip
                *ngFor="let skill of employee.skills"
                class="skill-chip"
              >
                {{ skill }}
              </mat-chip>
            </div>
          </div>
          <div
            class="certifications-section"
            *ngIf="employee.certifications?.length"
          >
            <h4>Certifications</h4>
            <div class="chip-list">
              <mat-chip
                *ngFor="let cert of employee.certifications"
                class="cert-chip"
              >
                <mat-icon>verified</mat-icon>
                {{ cert }}
              </mat-chip>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Emergency Contact -->
      <mat-card class="info-card" *ngIf="employee.emergencyContact?.name">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>contact_emergency</mat-icon>
            Emergency Contact
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="info-grid">
            <div class="info-item">
              <label>Name</label>
              <div class="info-value">
                <mat-icon>person</mat-icon>
                <span>{{ employee.emergencyContact.name }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>Relationship</label>
              <div class="info-value">
                <mat-icon>family_restroom</mat-icon>
                <span>{{ employee.emergencyContact.relationship }}</span>
              </div>
            </div>
            <div class="info-item">
              <label>Phone</label>
              <div class="info-value">
                <mat-icon>phone</mat-icon>
                <span>{{ employee.emergencyContact.phone }}</span>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Notes -->
      <mat-card class="info-card notes-card" *ngIf="employee.notes">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>note</mat-icon>
            Notes
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p class="notes-text">{{ employee.notes }}</p>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button mat-raised-button color="primary" (click)="editEmployee()">
        <mat-icon>edit</mat-icon>
        Edit Employee
      </button>
      <button mat-raised-button color="warn" (click)="deleteEmployee()">
        <mat-icon>delete</mat-icon>
        Delete Employee
      </button>
      <button mat-stroked-button (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
        Back to List
      </button>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="!isLoading && !employee">
    <mat-card class="error-card">
      <mat-card-content>
        <div class="error-content">
          <mat-icon>error</mat-icon>
          <h3>Employee Not Found</h3>
          <p>The requested employee could not be found.</p>
          <button mat-raised-button color="primary" (click)="goBack()">
            <mat-icon>arrow_back</mat-icon>
            Back to Employee List
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
